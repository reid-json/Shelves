version: 0.2

phases:
  install:
    commands:
      - curl -fsSL https://deb.nodesource.com/setup_22.x | bash -
      - apt-get install -y nodejs
      - export PATH=/usr/bin:$PATH
      - node -v
      - npm -v
      - echo "INSTALL complete"
  build:
    commands:
      - ls -la
      - echo "Trying to cd into frontend/app..."
      - cd frontend/app || (echo "Directory not found — dumping tree:" && find . -type d && exit 1)
      - npm install
      - npm run build
      - echo "Build complete — dumping dist:"
      - ls -la dist
  post_build:
    commands:
      - echo "Syncing dist to S3..."
      - ls -la dist || echo "dist folder not found"
      - aws s3 sync dist/ s3://my-vue-app-bucket-shelves --delete --exact-timestamps --debug


artifacts:
  files:
    - '**/*'